    #include<stdio.h>
    #include<string.h>
    #include<stdlib.h>
    #include<windows.h>
    #include<conio.h>

    void remove_string(char n[1000])
    {
        int i = 0;
        while(n[i]!='\0')
        {
            n[i]='\0';
            i++;
        }
    }

    struct customer
    {
        char name[100];
        char password[100];
        char phone[50];
        char date_of_birth[20];
        char best_friend[50];
    };

    struct customer cus[10000];


    struct owner
    {
        int yes;
        char nickname[50];
        char password[50];
        char phone[50];
        char date_of_birth[50];
        char best_friend[50];
    };

    struct owner own;


    void gotoxy(int x, int y)
    {
        COORD c;
        c.X = x;
        c.Y = y;
        SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE) , c);
    }


    void space(int a,int b)
    {
        COORD position;
        position.X = a;
        position.Y = b;
        SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE),position);
    }

    void clear(int n)
    {
        for(int i=0;i<n*2;i++)
        {
            space(0,i);
            printf("                                                                                                                                              \n                                                                                                                                             \n");
        }
        space(0,0);
    }

    int main()
    {


///opening fodx
        int x_axix=42;
        int y_axix=12;
        gotoxy(x_axix , y_axix);
        printf("00000     00000     000000     00     00\n");
        gotoxy(x_axix , y_axix+1);
        printf("00       00   00    00   00      00 00\n");
        gotoxy(x_axix , y_axix+2);
        printf("00000    00   00    00    00      000\n");
        gotoxy(x_axix , y_axix+3);
        printf("00       00   00    00   00      00 00\n");
        gotoxy(x_axix , y_axix+4);
        printf("00        00000     000000     00     00\n");

        usleep(2000000);
        ///clear screen
        clear(15);

        int user;

///part:1  struct update from file
        part1:

        user = 0;
        int time1 = 610;
        int yes;
        int part=-1;
        int key;
        int key1;
        int key2=0;
        int key3=-1;
        int key4=0;
        int key5=0;
        int key6,key7,key8,key9,key10,key11,key12,key13,key14,key15;
        int id1;
        int del=0;
        int id2;
        int id3;
        char dob[100];
        char dob1[100];
        char phone2[100];
        int flag=0;
        int flag1=0;
        int flag5;
        int length;
        int length1;
        int length3;
        int length2;
        int flag4;
        char password1[100];
        char password2[100];
        char password5[100];
        char phone1[100];
        char check_phone[100];
        char check_date_of_birth[100];
        char best_friend1[100];
        char nickname[100];
        char c_phone_number[50];
        int wrong1 = 0;
        int wrong3 = -1;
        int wrong4 = -1;
        char cus_history[100];
        char phone3[100];
        char phone5[100];
        char phone6[100];
        char ch1;
        char dob2[50];
        char phone4[50];
        char best_friend2[50];
        char date_of_birth[50];
        char date_of_birth2[50];




        FILE *p;


        int result;
        int n1,n2;

        int struct_index = 1;

        p = fopen("customer_profile.txt","a+");

        int line = 0;

        while(!feof(p))
        {
            if(line==0)
                fscanf(p, "%s" ,&cus[struct_index].name);
            if(line==1)
                fscanf(p, "%s" ,&cus[struct_index].password);
            if(line==2)
                fscanf(p, "%s" ,&cus[struct_index].phone);
            if(line==3)
                fscanf(p, "%s" ,&cus[struct_index].date_of_birth);
            if(line==4)
                fscanf(p, "%s" ,&cus[struct_index].best_friend);

            line++;

            if(line==5)
            {
                line=0;
                struct_index++;
                user++;
            }
        }

        fclose(p);


        if(part==8)
        {
            part = 0;
            wrong4=0;
            goto part5;
        }
///part:2   file update from struct
        part2:
        p = fopen("customer_profile.txt","w");

        for(int i=1;i<=user;i++)
        {
            if(del==1 && id3==i)
            {
                del=0;
                id3=0;
                continue;
            }

            fputs(cus[i].name,p);

            fputs("\n",p);
            fputs(cus[i].password,p);

            fputs("\n",p);
            fputs(cus[i].phone,p);

            fputs("\n",p);
            fputs(cus[i].date_of_birth,p);

            fputs("\n",p);
            fputs(cus[i].best_friend,p);

            fputs("\n",p);
        }

        fclose(p);

        if(part==7)
        {
            part=0;
            goto part6;
        }

        if(part==8)
        {
            part=0;
            user++;  ///because for signing up a new account had been added...
            goto part6;
        }
        if(part==9)
        {
            part=0;
            goto part1;
        }

///part:3     choose customer and owner
        part3:
        if(wrong1==1)
        {
            wrong1=0;
            printf("***  You have choosen the wrong key  ***\n    ***  please try again  ***\n\n");
        }

        printf("Who are you?\n");
        printf("1. I am customer...\n");
        printf("2. I am the owner...\n");
        printf("Enter the key : ");
        scanf("%d",&key);

        ///loading part...
        printf("Loading");
        for(int i=0;i<4;i++)
        {
            usleep(time1);
            printf(" .");
        }

        ///clear screen
        clear(7);

        ///choose log in...
        if(key==1)
        {
///part:4    choose sign up or log in
            while(1)
            {
            part4:
            printf("account:\n========\n");
            printf("1. log in\n");
            printf("2. sign up\n");
            printf("3. Back\n");
            printf("Enter the key : ");
            scanf("%d",&key1);

            ///clear screen
            clear(7);

            if(key1==3)
            {
                goto part3;
            }
///part:5    enter wrong password
            key2=0;
            wrong4=0;

            if(key1==1)
            {
                part5:
                if(wrong4 == 1)
                {
                    printf("*** Wrong information ***\n1. forget password\n2. try again\n-1. back\n");
                    scanf("%d",&key2);
                }

                ///clear screen
                clear(7);

                if(wrong4==0)
                    goto part6;

                if(key2==1)
                {
                    wrong3=1;
                    goto part7;
                }
                else if(key2==-1)
                    goto part3;
                else if(key2==2)  ///try again
                    goto part6;
                else
                {
                    printf("enter right key\n");
                    wrong4=1;
                    goto part5;
                }

///part6  log in
                part6:
                printf("log in\n========\n");
                printf("enter phone number : ");
                scanf("%s",&phone1);

                flag5=0;
                for(int i=1;i<=user;i++)
                {
                    if(strcmp(cus[i].phone , phone1)==0)
                    {
                        flag5=1;
                        goto part6b;
                    }
                }
                if(flag5==0)
                {
                    while(1)
                    {
///part6a
                    part6a:
                    ///clear screen
                    clear(7);
                    printf("There is no account for this number \n");
                    printf("1. Try again\n");
                    printf("2. Back\n");
                    printf("\nEnter the key : ");

                    scanf("%d",&key10);
                    if(key10==1)
                    {
                        ///clear screen
                        clear(8);
                        goto part6;
                    }
                    if(key10==2)
                    {
                        ///clear screen
                        clear(8);
                        goto part4;
                    }
                    ///clear screen
                    clear(8);
                    }
                  }

///part6b
                part6b:
                printf("Enter password : ");
                scanf("%s",&password1);
                printf("Answer the question : \n");

                srand(time(0));

                n1 = rand()%5;
                n2 = rand()%5;
                printf("%d + %d = ",n1,n2);
                scanf("%d",&result);


                ///loading part...
                printf("Loading");
                for(int i=0;i<4;i++)
                {
                    usleep(time1);
                    printf(" .");
                }

                ///clear screen
                clear(7);


                flag=0;
                for(int i=1;i<=user;i++)
                {
                    if(strcmp(cus[i].phone , phone1)==0)
                    {
                        id1=i;
                        flag=1;
                        break;
                    }
                }
                if(strcmp(cus[id1].password , password1) == 0  && (n1+n2)==result && flag==1)
                {
                    id2=id1;
                    wrong4= 0;
                    goto part9;
                }
                else
                {
                    wrong4 = 1;
                    goto part5;
                }



///part7   change password
                part7:
                ///clear screen
                clear(8);
                if(wrong3==1)
                {
                    wrong3=0;
                    printf("Answer the question\n");
                    printf("Enter your phone number : ");
                    scanf("%s",&phone2);
                    printf("What is your date of birth (DD/MM/YYYY): ");
                    scanf("%s",&dob);
                    printf("What is your Best friend nickname : ");
                    scanf("%s",&best_friend1);

                    length = strlen(dob);
                    length1 = strlen(phone2);


                    srand(time(0));

                    n1 = rand()%5;
                    n2 = rand()%5;
                    printf("Answer the question:\n");
                    printf("%d + %d = ",n1,n2);
                    scanf("%d",&result);



                    ///loading part...
                    printf("Loading");
                    for(int i=0;i<4;i++)
                    {
                        usleep(time1);
                        printf(" .");
                    }
                    ///clear screen
                    clear(7);

                    flag4=0;
                    for(int i=1;i<=user;i++)
                    {
                        if(strcmp(cus[i].phone , phone2)==0 && strcmp(cus[i].best_friend , best_friend1)==0  &&  strcmp(cus[i].date_of_birth , dob)==0 && n1+n2==result && (length==9 || length==10) && length1==11)
                        {
                            id1=i;
                            flag4=1;
                            break;
                        }
                    }

                    if(flag4==0)
                    {
                        ///clear screen
                        clear(7);
                        goto part5;
                    }

                    printf("Charge password : ");
                    scanf("%s",cus[id1].password);
                    part=7;
                    wrong4=0;
                    ///clear screen
                    clear(7);
                    goto part2;

                    }
                    else
                    {
                    ///clear screen
                    clear(7);
                    goto part5;
                    }
            }

            if(key1==2)
            {
///part:8   sign up

                part8:

                printf("sign in :\n==========\n");
                printf("enter your phone number :");
                scanf("%s",&check_phone);
                length2 = strlen(check_phone);
                for(int i=1;i<=user;i++)
                {
                    if(strcmp(cus[i].phone , check_phone)==0 || length2!=11)
                    {
///part8a
                        part8a:
                        ///clear screen
                        clear(7);

                        printf("You can't use this number\n");
                        printf("1. Try again\n");
                        printf("2. Back\n");
                        printf("=================\n");
                        printf("Enter the key : ");
                        scanf("%d",&key9);
                        if(key9==1)
                        {
                            ///clear screen
                            clear(7);
                            goto part8;
                        }
                        if(key9==2)
                        {
                            ///clear screen
                            clear(7);
                            goto part3;
                        }
                        else
                        {
                            ///clear screen
                            clear(7);
                            goto part8a;
                        }
                    }
                }

                printf("Enter your date of birth (DD/MM/YYYY) :");
                scanf("%s",&check_date_of_birth);
                length3 = strlen(check_date_of_birth);


                if(length3!=10)
                {
                    ///clear screen
                    clear(7);
                    printf("Please enter correct information\n\n");
                    goto part8;
                }
                user++;

                strcpy(cus[user].phone , check_phone);
                strcpy(cus[user].date_of_birth , check_date_of_birth);
                printf("enter your nickname :");
                scanf("%s",&cus[user].name);

                printf("enter password :");
                scanf("%s",&cus[user].password);

                printf("Enter your best friend name : ");
                scanf("%s",&cus[user].best_friend);

                ///clear screen
                clear(7);


                    ///loading part...
                    for(int i=10;i<110;i+=10)
                    {
                    printf("Creating account : (%d %%)",i);
                    usleep(time1);

                    ///clear screen
                    clear(7);
                    }

                    ///clear screen
                    clear(7);

                    printf("Log in your account:\n\n");

                    part=8;
                    goto part2;
                }
                if(key1==3)
                {
                   ///clear screen
                    clear(7);
                    wrong1=0;
                    goto part3;
                }
            }
        }
        if(key==2)
        {
///======================================================================================
///owner part
        wrong1 = 0;
        part=0;
///part8b1
///struct will update  from file:
        part8b1:

        p=fopen("owner.txt","a+");

        while(!feof(p))
        {
            fscanf(p,"%d",&own.yes);
            fscanf(p,"%s",&own.nickname);
            fscanf(p,"%s",&own.phone);
            fscanf(p,"%s",&own.password);
            fscanf(p,"%s",&own.date_of_birth);
            fscanf(p,"%s",&own.best_friend);
        }

        fclose(p);

///check is there any owner account in file...


            if(own.yes==1)
            {
                ///clear screen
                clear(7);
                goto part8d;
            }
            else
            {
                ///clear screen
                clear(7);
                goto part8b;
            }



///if there is no account for the owner then the sign up part will work and if there is an account for the owner then the log in part will work

///part8b:
///owner sign up part
        part8b:
        while(1)
        {
            printf("Sign up : \n===============\n");
            printf("Enter your phone number: ");
            scanf("%s",&phone4);
            if(strlen(phone4)==11)
            {
                break;
            }
            else
            {
                ///clear screen
                clear(7);
                printf("Enter correct information\n\n");
            }
        }
            printf("Enter your Date of birth (DD/MM/YYYY) : ");
            scanf("%s",&dob2);
            if(strlen(dob2)!=10)
            {
                ///clear screen
                clear(7);
                printf("Enter correct information\n\n");
                goto part8b;
            }

            strcpy(own.phone , phone4);
            strcpy(own.date_of_birth , dob2);

            own.yes = 1;

            printf("Your nickname : ");
            scanf("%s",&own.nickname);

            printf("Your best friend nickname : ");
            scanf("%s",&own.best_friend);

            printf("Enter password : ");
            scanf("%s",&own.password);

            ///clear screen
            clear(7);
            goto part8c;

///owner file update from struct
///part8c
        part8c:

        p= fopen("owner.txt","w");

        fprintf(p,"1\n");
        fprintf(p,"%s\n",own.nickname);
        fprintf(p,"%s\n",own.phone);
        fprintf(p,"%s\n",own.password);
        fprintf(p,"%s\n",own.date_of_birth);
        fprintf(p,"%s\n",own.best_friend);

        fclose(p);

///owner log in part:
///part8d:
        part8d:
        printf("Log in :\n===========\n");
        printf("Enter your phone number : ");
        scanf("%s",&phone5);
        printf("Enter password : ");
        scanf("%s",&password5);

        if(strcmp(phone5 , own.phone)==0 && strcmp(password5,own.password)==0)
            goto part12;
        else
        {
            while(1)
            {
            ///clear screen
            clear(7);
            printf("Wrong information...\n");
            printf("1. Try again\n");
            printf("2. Forget password\n");
            printf("3. Back\n=======================\n");
            printf("Enter the key : ");
            scanf("%d",&key12);

            if(key12==1)
            {
                ///clear screen
                clear(7);
                goto part8d;
            }
            else if(key12==2)
            {
                ///clear screen
                clear(7);
                goto part8e;
            }
            else if(key12==3)
            {
                ///clear screen
                clear(7);
                goto part3;
            }
            }
        }
///change password for owner
///part8e
        part8e:
        printf("Enter your best friend name : ");
        scanf("%s",&best_friend2);
        printf("Enter your date of birth (DD/MM/YYYY): ");
        scanf("%s",&date_of_birth2);

        if(strcmp(date_of_birth2 , own.date_of_birth)==0  &&  strcmp(best_friend2 , own.best_friend)==0)
        {
            printf("Enter new password : ");
            scanf("%s",&own.password);

            ///clear screen
            clear(7);

            goto part8c;
        }
        else
        {
        while(1)
           {
            ///clear screen
            clear(7);
            printf("Wrong information\n");
            printf("1. Try again\n");
            printf("2. Back\n");
            scanf("%d",&key13);

            if(key13==1)
            {
                ///clear screen
                clear(7);
                goto part8e;
            }
            if(key13==2)
            {
                ///clear screen
                clear(7);
                goto part3;
            }
           }
          }
        }
        else
        {
            ///clear screen
            clear(7);
            wrong1 = 1;
            goto part3;
        }
///==================================================================================================
///owner and customer menu part...
///part9   customer menu

        part9:
        ///clean screen
        clear(25);
        printf("As-salamu alaykum %s\n",cus[id1].name);

        printf("Menu:\n=========\n");
        printf("1. My profile\n");
        printf("2. Order food\n");
        printf("3. My order history\n");
        printf("4. Log out\n");
        printf("5. Delete account\n");
        printf("6. Account setting\n");
        printf("==================\n");
        printf("Enter the key: ");
        scanf("%d",&key3);


        ///loading part...
        printf("Loading");
        for(int i=0;i<4;i++)
        {
            usleep(time1);
            printf(" .");
        }

        ///clean screen
        clear(8);
        if(key3==1)
        {
///part10:
            part10:
            ///clear screen
            clear(7);
            printf("Profile:\n==========\n");
            printf("Nickname         : %s\n",cus[id2].name);
            printf("Phone number     : %s\n",cus[id2].phone);
            printf("password         : %s\n",cus[id2].password);
            printf("Date of birth    : %s\n",cus[id2].date_of_birth);
            printf("Best friend name : %s\n",cus[id2].best_friend);

            printf("\n1. Back\n");
            printf("Enter key : ");
            scanf("%d",&key4);

            ///clean screen
            clear(8);

            if(key4==1)
                goto part9;
            else
                goto part10;
        }
        if(key3==2)
        {
///part10a  5 times of meal part
            part10a:
            ///clean screen
            clear(30);
            printf("Order Food :\n================\n");

            printf("1. Breakfast\n");
            printf("2. Snack\n");
            printf("3. Lunch\n");
            printf("4. Supper\n");
            printf("5. Dinner\n===============");
            printf("\n-1. back\nEnter key : ");
            scanf("%d",&key6);

            if(key6==1)
            {
///part10b   breakfast order part
                part10b:
                ///clean screen
                clear(20);

                printf("Breakfast :\n=============");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n=================\n");

                printf("-1 . Back");

                printf("\n\nEnter key to order food : ");

                scanf("%d",&key6);

                if(key6==-1)
                    goto part10a;
                else
                {
                    goto part10b;
                }
              }
            }

        if(key3==3)
        {
///part11
            part11:
            strcpy(phone3 , cus[id1].phone);
            strcat(phone3 , ".txt");
            strcpy(cus_history , phone3);

            p = fopen(cus_history , "a+");

            printf("My order history :\n===================\n");
            while(!feof(p))
            {
                ch1 = fgetc(p);
                printf("%c",ch1);
            }

            fclose(p);

            printf("\n\n1. Back\nEnter key : ");
            scanf("%d",&key5);

            if(key5==1)
            {
                goto part9;
            }
            else
                goto part11;
        }
        if(key3==4)
        {
            remove_string(phone3);
            id2=id3=id1=0;
            remove_string(cus_history);
            goto part1;
        }
        if(key3==5)
        {
            remove_string(phone3);
            remove(cus_history);
            part = 9;
            id3=id2;
            del=1;
            goto part2;
        }
        if(key3==6)
        {
///part11a   reset account part
            part11a:
            ///clear screen
            clear(8);
            printf("For security:\n===============\n");
            printf("Enter the password : ");
            scanf("%s",&password2);

            if(strcmp(cus[id1].password , password2)==0)
            {
///part11b
                part11b:
                while(1)
                {
                ///clear screen
                clear(8);
                printf("Account setting :\n===================\n");
                printf("1. Change nickname\n");
                printf("2. Change Date of birth\n");
                printf("3. Change password\n");
                printf("4. Back\n==================\n");
                printf("Enter the key : ");
                scanf("%d",&key8);

                if(key8==1)
                {
                    printf("Previous nickname : %s\n",cus[id1].name);
                    printf("New nickname : ");
                    scanf("%s",&cus[id1].name);
                }
                if(key8==2)
                {
                    printf("Previous Date of birth : %s\n",cus[id1].date_of_birth);
                    printf("New Date of birth : ");
                    scanf("%s",&cus[id1].date_of_birth);
                }
                if(key8==3)
                {
                    printf("Previous password : %s\n",cus[id1].password);
                    printf("New password : ");
                    scanf("%s",&cus[id1].password);
                }
                if(key8==4)
                {
                    goto part9;
                }
                else
                {
                    goto part11b;
                }
                }
            }
            else
            {
                ///clear screen
                clear(8);
///part11c
                part11c:
                ///clear screen
                clear(8);
                printf("1. (wrong password) Try again\n");
                printf("2. Back to the Menu\n=======================\n");
                printf("Enter the key : ");
                scanf("%d",&key7);

                if(key7==1)
                {
                    goto part11a;
                }
                if(key7==2)
                {
                    goto part9;
                }
                else
                {
                    goto part11c;
                }
            }
        }
        else
        {
            goto part9;
        }
///=========================================================================================printtf=========
///owner menu:
        part12:
        while(1)
        {
        ///clear screen
        clear(8);
        printf("As-salamu alaykum %s\n\n",own.nickname);
        printf("Menu\n==========\n");
        printf("1. My profile\n");
        printf("2. customer order\n");
        printf("3. Add food\n");
        printf("4. remaining food\n");
        printf("5. Log out\n========================\n");
        printf("6. Enter the key : ");

        scanf("%d",&key14);

        if(key14==1)
        {
            while(1)
            {
            ///clear screen
            clear(8);
            printf("Profile : \n==============\n");
            printf("Nickname         : %s\n",own.nickname);
            printf("Phone number     : %s\n",own.phone);
            printf("Password         : %s\n",own.password);
            printf("Date of birth    : %s\n",own.date_of_birth);
            printf("Best friend name : %s\n\n",own.best_friend);
            printf("1. Back\n");
            printf("Enter the key : ");
            scanf("%d",&key15);
            if(key15==1)
            {
                ///clear screen
                clear(8);
                goto part12;
            }
            }
        }
        if(key14==2)
        {

        }
        if(key14==3)
        {

        }
        if(key14==4)
        {

        }
        if(key14==5)
        {
            ///clear screen
            clear(8);
            goto part3;
        }
        }


        return 0;
}
