    #include<stdio.h>
    #include<string.h>
    #include<stdlib.h>
    #include<windows.h>
    #include<conio.h>

    void remove_string(char n[1000])
    {
        int i = 0;
        while(n[i]!='\0')
        {
            n[i]='\0';
            i++;
        }
    }

    struct customer
    {
        char name[100];
        char password[100];
        char phone[50];
        char date_of_birth[20];
    };

    struct customer cus[10000];


    void space(int a,int b)
    {
        COORD position;
        position.X = a;
        position.Y = b;
        SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE),position);
    }

    void clear(int n)
    {
        for(int i=0;i<n*2;i++)
        {
            space(0,i);
            printf("                                                                                        \n                                                                                       \n");
        }
        space(0,0);
    }

    int main()
    {

        int user;

///part:1  struct update from file
        part1:

        user = 0;
        int time1 = 610;
        int part=-1;
        int key;
        int key1;
        int key2=0;
        int key3=-1;
        int key4=0;
        int key5=0;
        int key6;
        int id1;
        int del=0;
        int id2;
        int id3;
        char dob[100];
        char dob1[100];
        char phone2[100];
        int flag=0;
        int flag1=0;
        int length;
        int length1;
        int length3;
        int length2;
        int flag4;
        char password1[100];
        char phone1[100];
        char check_phone[100];
        char check_date_of_birth[100];
        char nickname[100];
        char c_phone_number[50];
        int wrong1 = 0;
        int wrong3 = -1;
        int wrong4 = -1;
        char cus_history[100];
        char phone3[100];
        char ch1;



        FILE *p;


        int result;
        int n1,n2;

        int name_index = 0;
        int password_index = 0;
        int phone_index = 0;
        int date_of_birth_index = 0;
        int struct_index = 1;
        int start;

        char c_name[100];
        char c_phone[100];
        char c_password[100];
        char c_date_of_birth[20];

        p = fopen("customer_profile.txt","r");

        int line = 1;

        start = 1;
        remove_string(c_date_of_birth);
        while(!feof(p))
        {
            char ch;

            ch = fgetc(p);
            int enter = ch;

            if(enter==10)
                start=0;

            if(start==1 && line==1)
            {
                c_name[name_index] = ch;
                name_index++;
            }
            if(start==1 && line==2)
            {
                c_password[password_index] = ch;
                password_index++;
            }
            if(start==1 && line==3)
            {
                c_phone[phone_index] = ch;
                phone_index++;
            }
            if(start==1 && line==4)
            {
                c_date_of_birth[date_of_birth_index] = ch;
                date_of_birth_index++;
            }
            if(start==0 && line==1)
            {
                strcpy(cus[struct_index].name, c_name);
                remove_string(c_name);
                name_index = 0;
                line++;
                start=1;
            }
            if(start==0 && line==2)
            {
                strcpy(cus[struct_index].password , c_password);
                remove_string(c_password);
                password_index=0;
                line++;
                start=1;
            }
            if(start==0 && line==3)
            {
                remove_string(cus[struct_index].phone);
                strncat(cus[struct_index].phone , c_phone , 11);
                remove_string(c_phone);
                phone_index = 0;
                line++;
                start=1;
            }
            if(start==0 && line==4)
            {
                remove_string(cus[struct_index].date_of_birth);
                strncat(cus[struct_index].date_of_birth , c_date_of_birth,10);
                remove_string(c_date_of_birth);
                date_of_birth_index=0;
                line++;
                start=1;
            }


            if(line==5)
            {
                struct_index++; ///index of struct cus...
                line=1;
                user++;
            }
        }

        fclose(p);


        if(part==8)
        {
            part = 0;
            wrong4=0;
            goto part5;
        }
///part:2   file update from struct
        part2:
        p = fopen("customer_profile.txt","w");

        for(int i=1;i<=user;i++)
        {
            if(del==1 && id3==i)
            {
                del=0;
                id3=0;
                continue;
            }

            fputs(cus[i].name,p);

            fputs("\n",p);
            fputs(cus[i].password,p);

            fputs("\n",p);
            fputs(cus[i].phone,p);

            strncat(dob1,cus[i].date_of_birth,10);
            fputs("\n",p);
            fputs(cus[i].date_of_birth,p);

            fputs("\n",p);
        }

        fclose(p);

        if(part==7)
        {
            part=0;
            goto part6;
        }

        if(part==8)
        {
            part=0;
            goto part6;
        }
        if(part==9)
        {
            part=0;
            goto part1;
        }

///part:3     choose customer and owner
        part3:
        if(wrong1==1)
        {
            wrong1=0;
            printf("***  You have choosen the wrong key  ***\n    ***  please try again  ***\n\n");
        }

        printf("Who are you?\n1. I am customer...\n2. I am the owner...\nEnter the key : ");
        scanf("%d",&key);

        ///loading part...
        printf("Loading");
        for(int i=0;i<4;i++)
        {
            usleep(time1);
            printf(" .");
        }

        ///clear screen
        clear(7);

        ///choose log in...
        if(key==1)
        {
///part:4    choose sign up or log in

            printf("account:\n========\n1. log in\n2. sign up\nEnter the key : ");
            scanf("%d",&key1);

            ///clear screen
            clear(7);
///part:5    enter wrong password
            key2=0;
            wrong4=0;
            if(key1==1)
            {
                part5:
                if(wrong4 == 1)
                {
                    printf("*** Wrong information ***\n1. forget password\n2. try again\n-1. back\n");
                    scanf("%d",&key2);
                }

                ///clear screen
                clear(7);

                if(wrong4==0)
                    goto part6;

                if(key2==1)
                {
                    wrong3=1;
                    goto part7;
                }
                else if(key2==-1)
                    goto part3;
                else if(key2==2)  ///try again
                    goto part6;
                else
                {
                    printf("enter right key\n");
                    wrong4=1;
                    goto part5;
                }

///part6  log in
                part6:
                printf("log in\n========\n");
                printf("enter phone number : ");
                scanf("%s",&phone1);
                printf("enter password : ");
                scanf("%s",&password1);
                printf("answer the question : \n");

                srand(time(0));

                n1 = rand()%5;
                n2 = rand()%5;
                printf("%d + %d = ",n1,n2);
                scanf("%d",&result);


                ///loading part...
                printf("Loading");
                for(int i=0;i<4;i++)
                {
                    usleep(time1);
                    printf(" .");
                }

                ///clear screen
                clear(7);


                flag=0;
                for(int i=1;i<=user;i++)
                {
                    if(strcmp(cus[i].phone , phone1)==0)
                    {
                        id1=i;
                        flag=1;
                        break;
                    }
                }
                if((strcmp(cus[id1].password , password1) == 0)  && ((n1+n2)==result) && flag==1)
                {
                    id2=id1;
                    wrong4= 0;
                    goto part9;
                }
                else
                {
                    wrong4 = 1;
                    goto part5;
                }



///part7   change password
                part7:
                if(wrong3==1)
                {
                    wrong3=0;
                    printf("Answer the question\n");
                    printf("What is your date of birth (DD/MM/YYYY): ");
                    scanf("%s",&dob);
                    printf("What is your phone number: ");
                    scanf("%s",&phone2);

                    length = strlen(dob);
                    length1 = strlen(phone2);


                    srand(time(0));

                    n1 = rand()%5;
                    n2 = rand()%5;
                    printf("Answer the question:\n");
                    printf("%d + %d = ",n1,n2);
                    scanf("%d",&result);



                    ///loading part...
                    printf("Loading");
                    for(int i=0;i<4;i++)
                    {
                        usleep(time1);
                        printf(" .");
                    }
                    ///clear screen
                    clear(7);

                    flag4=0;
                    for(int i=1;i<=user;i++)
                    {
                        if(strcmp(cus[i].phone , phone2)==0 && strcmp(cus[i].date_of_birth , dob)==0 && n1+n2==result && (length==9 || length==10) && length1==11)
                        {
                            id1=i;
                            flag4=1;
                            break;
                        }
                    }

                    if(flag4==0)
                    {
                        ///clear screen
                        clear(7);
                        goto part5;
                    }

                    printf("charge password : ");
                    scanf("%s",cus[id1].password);
                    part=7;
                    wrong4=0;
                    ///clear screen
                    clear(7);
                    goto part2;

                    }
                    else
                    {
                    ///clear screen
                    clear(7);
                    goto part5;
                    }
            }

            if(key1==2)
            {
///part:8   sign up

                part8:

                printf("sign in :\n=========\n");
                printf("enter your phone number :");
                scanf("%s",&check_phone);
                length2 = strlen(check_phone);
                for(int i=1;i<=user;i++)
                {
                    if(strcmp(cus[i].phone , check_phone)==0 || length2!=11)
                    {
                        ///clear screen
                        clear(7);

                        printf("You can't use this number\n");
                        goto part8;
                    }
                }

                printf("Enter your date of birth (DD/MM/YYYY) :");
                scanf("%s",&check_date_of_birth);
                length3 = strlen(check_date_of_birth);


                if(length3!=10)
                {
                    ///clear screen
                    clear(7);
                    printf("Please enter correct information\n\n");
                    goto part8;
                }
                user++;

                strcpy(cus[user].phone , check_phone);
                strcpy(cus[user].date_of_birth , check_date_of_birth);
                printf("enter your nickname :");
                scanf("%s",&cus[user].name);

                printf("enter password :");
                scanf("%s",&cus[user].password);

                ///clear screen
                clear(7);


                    ///loading part...
                    for(int i=10;i<110;i+=10)
                    {
                    printf("Creating account : (%d %%)",i);
                    usleep(time1);

                    ///clear screen
                    clear(7);
                    }

                    ///clear screen
                    clear(7);

                    printf("Log in your account:\n\n");

                    part=8;
                    goto part2;
                }
        }
        if(key==2)
        {
            ///owner part
            wrong1 = 0;

            printf("go");


        }
        else
        {
            ///clear screen
            clear(7);
            wrong1 = 1;
            goto part3;
        }

///part9   menu

        part9:
        ///clean screen
        clear(25);
        printf("As-salamu alaykum %s\n",cus[id1].name);

        printf("Menu:\n=========\n");
        printf("1. My profile\n");
        printf("2. Order food\n");
        printf("3. My order history\n");
        printf("4. Log out\n");
        printf("5. Delete account\n");
        printf("==================\n");
        printf("Enter the key: ");
        scanf("%d",&key3);


        ///loading part...
        printf("Loading");
        for(int i=0;i<4;i++)
        {
            usleep(time1);
            printf(" .");
        }

        ///clean screen
        clear(8);
        if(key3==1)
        {
///part10:
            part10:
            ///clear screen
            clear(7);
            printf("Profile:\n==========\n");
            printf("Nickname      : %s\n",cus[id2].name);
            printf("Phone number  : %s\n",cus[id2].phone);
            printf("password      : %s\n",cus[id2].password);
            printf("Date of birth : %s\n",cus[id2].date_of_birth);

            printf("\n1. Back\n");
            printf("Enter key : ");
            scanf("%d",&key4);

            ///clean screen
            clear(8);

            if(key4==1)
                goto part9;
            else
                goto part10;
        }
        if(key3==2)
        {
///part10a  5 times of meal part
            part10a:
            ///clean screen
            clear(30);
            printf("Order Food :\n================\n");

            printf("1. Breakfast\n");
            printf("2. Snack\n");
            printf("3. Lunch\n");
            printf("4. Supper\n");
            printf("5. Dinner\n===============");
            printf("\n-1. back\nEnter key : ");
            scanf("%d",&key6);

            if(key6==1)
            {
///part10b   breakfast order part
                part10b:
                ///clean screen
                clear(20);

                printf("Breakfast :\n=============");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n");
                printf(". \n=================\n");

                printf("-1 . Back");

                printf("\n\nEnter key to order food : ");

                scanf("%d",&key6);

                if(key6==-1)
                    goto part10a;
                else
                {
                    goto part10b;
                }
              }
            }

        if(key3==3)
        {
///part11
            part12:
            strcpy(phone3 , cus[id1].phone);
            strcat(phone3 , ".txt");
            strcpy(cus_history , phone3);
            FILE *p1;

            p1 = fopen(cus_history , "a+");

            printf("My order history :\n===================\n");
            while(!feof(p1))
            {
                ch1 = fgetc(p1);
                printf("%c",ch1);
            }

            fclose(p1);

            printf("\n\n1. Back\nEnter key : ");
            scanf("%d",&key5);

            if(key5==1)
            {
                goto part9;
            }
            else
                goto part12;
        }
        if(key3==4)
        {
            remove_string(phone3);
            id2=id3=id1=0;
            remove_string(cus_history);
            goto part1;
        }
        if(key3==5)
        {
            remove_string(phone3);
            remove(cus_history);
            part = 9;
            id3=id2;
            del=1;
            goto part2;
        }
        else
        {
            goto part9;
        }


        return 0;
}
